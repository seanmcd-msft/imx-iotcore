<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup Label="UserMacros">
    <OEMName>NXP</OEMName>
  </PropertyGroup>
  <PropertyGroup>
    <CheckMSVCComponents>false</CheckMSVCComponents> <!-- stop vs from using non-wdk directory structure to validate spectre libs, arguably this is bug in the platform toolset.props but i can't find who owns that. -->
    <!-- Determine package output path depending if this is a build or dev machine -->
    <MainOutput>$(SolutionDir)Build\$(Platform)\$(Configuration)\</MainOutput>
    <PkgOutput >$(SolutionDir)Build\$(Platform)\$(Configuration)\</PkgOutput>
    <OutputPath>$(MainOutput)</OutputPath>
    <OutDir>$(MainOutput)$(ProjectName)\</OutDir>
    <IntermediateOutputPath>$(MainOutput)$(ProjectName)\</IntermediateOutputPath>
    <PackageDir>$(MainOutput)$(ProjectName)\</PackageDir>
    <UseCommonOutputDirectory>True</UseCommonOutputDirectory>
    <WindowsTargetPlatformMinVersion>10.0.16299.0</WindowsTargetPlatformMinVersion>
    <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>
    <TargetPlatformMinVersion>10.0.16299.0</TargetPlatformMinVersion>
    <LatestTargetPlatformMinVersion>10.0.16299.0</LatestTargetPlatformMinVersion>
    <MissingWDKPkgGenSupport Condition="'$(PkgGen_DefaultDriverDest)' == ''">true</MissingWDKPkgGenSupport>
  </PropertyGroup>


  <PropertyGroup Condition="'$(MissingWDKPkgGenSupport)' == 'true'">
        <EnablePkgGen Condition="'$(EnablePkgGen)' == '' and '$(DriverTargetPlatform)' != 'Desktop'">true</EnablePkgGen>
        <PkgGen_DefaultDriverDest Condition="'$(IsKernelModeToolset)' == 'true'">DRIVER_DEST=drivers</PkgGen_DefaultDriverDest>
        <PkgGen_DefaultDriverDest Condition="'$(IsUserModeToolset)' == 'true'">DRIVER_DEST=drivers\umdf</PkgGen_DefaultDriverDest>
  </PropertyGroup>

  <PropertyGroup
    Condition="'$(MissingWDKPkgGenSupport)' == 'true' and '$(PkgGenBeforeTargets)' == '' and '$(PkgGenAfterTargets)' == '' and '$(ConfigurationType)' != 'Makefile'">
    <PkgGenBeforeTargets>ApiValidator</PkgGenBeforeTargets>
    <PkgGenAfterTargets>AfterLink</PkgGenAfterTargets>
  </PropertyGroup>

  <ItemDefinitionGroup Condition="'$(MissingWDKPkgGenSupport)' == 'true'">
    <PkgGen>
      <ConfigurationFile>"$(WDKContentRoot)Tools\bin\i386\pkggen.cfg.xml"</ConfigurationFile>
      <Version>1.0.0.0</Version>
      <BuildType>fre</BuildType>
      <CPU>$(Platform)</CPU>
      <CommandLineTemplate>&quot;$(WDKContentRoot)Tools\bin\i386\pkggen.exe&quot;</CommandLineTemplate>
    </PkgGen>
  </ItemDefinitionGroup>

  <ItemDefinitionGroup>
    <PkgGen>
      <Variables>&quot;HIVE_ROOT=$(CoreSystem_HivesPath);WIM_ROOT=$(CoreSystem_HivesPath);_RELEASEDIR=$(PackageDir);TARGETNAME=$(TargetName);TARGETEXT=$(TargetExt);$(PkgGen_DefaultDriverDest);OEMNAME=$(OEMName)&quot;"</Variables>
    </PkgGen>
  </ItemDefinitionGroup>

  <ItemDefinitionGroup>
    <ClCompile>
      <SupportJustMyCode>false</SupportJustMyCode>
    </ClCompile>
    <ResourceCompile>
      <PreprocessorDefinitions Condition="'$(XefMSPropsImported)'=='true'">%(PreprocessorDefinitions);XES_MACHINE=1</PreprocessorDefinitions>
    </ResourceCompile>
    <BuildLog>
      <Path>$(SolutionDir)Build\$(Platform)\$(Configuration)\Logs\$(MSBuildProjectName).log</Path>
    </BuildLog>
  </ItemDefinitionGroup>
</Project>